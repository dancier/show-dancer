<div class="registration-wrapper" fxLayout="row" fxLayoutAlign="center center">
  <mat-card appearance="outlined" class="box">
    <mat-card-header>
      <mat-card-title data-test="title">Registrierung</mat-card-title>
    </mat-card-header>

    <form (ngSubmit)="submitForm()" [formGroup]="registrationForm" novalidate>
      <mat-card-content>
        <mat-form-field appearance="fill" class="full-width">
          <mat-label>E-Mail</mat-label>
          <input
            data-test="email-field"
            formControlName="email"
            matInput
            placeholder="max.mustermann@beispiel.de"
            type="email"
          />
          <mat-error
            *ngIf="errorHandling('email', 'required')"
            data-test="email-error-empty"
          >
            Bitte geben Sie Ihre E-Mail Adresse an.
          </mat-error>
          <mat-error
            *ngIf="errorHandling('email', 'email')"
            data-test="email-error-format"
          >
            Bitte geben Sie eine gültige E-Mail Adresse an.
          </mat-error>
        </mat-form-field>
        <mat-form-field appearance="fill" class="full-width">
          <mat-label>Passwort</mat-label>
          <input
            data-test="password-field"
            formControlName="password"
            matInput
            type="password"
          />
          <mat-error
            *ngIf="errorHandling('password', 'required')"
            data-test="password-field-empty"
          >
            Bitte geben Sie ein Passwort ein.
          </mat-error>
        </mat-form-field>
        <mat-form-field appearance="fill" class="full-width">
          <mat-label>Passwort wiederholen</mat-label>
          <input
            data-test="password-confirm-field"
            formControlName="passwordConfirm"
            matInput
            type="password"
          />
          <mat-error
            *ngIf="errorHandling('passwordConfirm', 'required')"
            data-test="password-confirm-field-empty"
          >
            Bitte geben Sie ein Passwort ein.
          </mat-error>
          <mat-error
            *ngIf="errorHandling('passwordConfirm', 'matching')"
            data-test="password-confirm-field-no-match"
          >
            Die eingegebenen Passwörter stimmen nicht überein.
          </mat-error>
        </mat-form-field>
        <div class="accept-terms">
          <mat-checkbox
            formControlName="acceptTermsAndConditions"
          ></mat-checkbox>
          <div>
            Ich habe die <a routerLink="/terms-and-conditions">AGBs</a> und die
            <a routerLink="/cookie-guidelines">Cookie-Richtlinien</a> gelesen
            und akzeptiere sie.
          </div>
        </div>
        <ng-container *ngIf="loggedInAsHuman; then thankYouHuman; else captcha">
        </ng-container>
        <ng-template #thankYouHuman>
          <p>Vielen Dank!</p>
        </ng-template>
        <ng-template #captcha>
          <div class="captcha">
            <re-captcha
              (resolved)="captchaResolved($event)"
              siteKey="6LetqBAgAAAAAJXA5K_U88bsxKtyp_vld6J0x-Nv"
            ></re-captcha>
          </div>
        </ng-template>
        <button
          [disabled]="!registrationForm.valid"
          class="btn-block full-width"
          color="primary"
          data-test="confirm-registration"
          mat-stroked-button
        >
          Registrieren
        </button>
        <mat-error *ngIf="error">
          <span> {{error | errorMessage}} </span>
        </mat-error>
      </mat-card-content>
    </form>
  </mat-card>
</div>
