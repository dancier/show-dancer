<div *ngIf="chatService.dancers$ | async as dancers">
  <code></code>
  <div class="chat-header">
    <h1>Deine Chats</h1>
  </div>
  <mat-grid-list cols="2">
    <mat-grid-tile>
      <div>
        <div *ngFor="let chat of chatService.chats$ | async">
          <div style="cursor: pointer" (click)="selectChat(chat.chatId)">
            {{ chat | partner:ownId!:dancers | name }}, {{ chat |
            partner:ownId!:dancers | city }}
          </div>
          <div>{{ chat.lastMessage.text }}</div>
        </div>
      </div>
    </mat-grid-tile>
    <mat-grid-tile>
      <div
        *ngIf="chatService.messagesByChat$ | async as messagesByChat"
      >
        <div
          *ngFor="let message of messagesByChat | messagesForChat:chatService.selectedChat"
        >
          {{message.text}}
        </div>
      </div>
      <form *ngIf="chatService.selectedChat" (ngSubmit)="submitForm()" [formGroup]="addMessageForm" novalidate>

        <mat-form-field appearance="standard" class="full-width">
          <mat-label>Neue Nachricht</mat-label>
          <input
            data-test="text-field"
            formControlName="text"
            matInput
            type="text"
          />
        </mat-form-field>

        <button class="big-button" color="primary" mat-flat-button type="submit">
          Senden
        </button>
      </form>
    </mat-grid-tile>
  </mat-grid-list>
</div>
